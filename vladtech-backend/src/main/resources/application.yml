spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${AUTH0_ISSUER_URI}
          audience: ${AUTH0_AUDIENCE}
  data:
    mongodb:
      uri: mongodb://localhost:27017/vladtechdb
      database: vladtechdb
      auto-index-creation: true

  # Default embedded version for local development
  mongodb:
    embedded:
      version: 6.0.8

  mail:
    host: localhost
    port: 1025
    username:
    password:
    properties:
      mail:
        smtp:
          auth: false
          starttls:
            enable: false

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

email:
  noreply: noreply@cle4rwater.ca

auth0:
  domain: ${AUTH0_DOMAIN}

  mgmt:
    clientId: ${AUTH0_MGMT_CLIENT_ID}
    clientSecret: ${AUTH0_MGMT_CLIENT_SECRET}
    audience: ${AUTH0_MGMT_AUDIENCE}

  roles:
    client: ${AUTH0_ROLE_CLIENT}
    employee: ${AUTH0_ROLE_EMPLOYEE}
    admin: ${AUTH0_ROLE_ADMIN}

  default:
    client:
      roleId: ${AUTH0_ROLE_DEFAULT}

renovation:
  rates:
    labor: 50.00
    overhead: 0.15
    contingency: 0.10
    tax: 0.13

---

spring:
  config:
    activate:
      on-profile: test

  # Local Tests (./gradlew test):
  # Clear URI to force the Embedded DB to start automatically
  data:
    mongodb:
      uri:
      auto-index-creation: true

  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ""
          audience: ""

renovation:
  rates:
    labor: 50.00
    overhead: 0.15
    contingency: 0.10
    tax: 0.13

---
spring:
  config:
    activate:
      on-profile: ci

  # CI Environment (GitHub Actions):
  # 1. Point to the REAL Mongo service (localhost:27017)
  # 2. Provide a safe version (6.0.8) so if Embedded tries to check metadata, it doesn't crash.
  # 3. Do NOT manually exclude/disable; Spring will detect the URI and assume we want the Real DB.
  data:
    mongodb:
      uri: mongodb://localhost:27017/vladtechdb
      auto-index-creation: true

  mongodb:
    embedded:
      version: 6.0.8

  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ""
          audience: ""

renovation:
  rates:
    labor: 50.00
    overhead: 0.15
    contingency: 0.10
    tax: 0.13

file:
  # Safe relative path for CI file permissions
  upload-dir: build/ci-uploads